---
phase: 04-quiz-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/quiz-loader.js
  - src/data/quizzes/quiz-1.json
autonomous: true

must_haves:
  truths:
    - "Quiz data for Lesson 1 is loadable via quiz-loader"
    - "Quiz has exactly 5 questions with 4 answer options each"
    - "Each question has one correct answer marked"
    - "Loader validates quiz structure before returning"
  artifacts:
    - path: "src/data/quiz-loader.js"
      provides: "Quiz loading with caching and validation"
      exports: ["loadQuiz", "validateQuiz"]
    - path: "src/data/quizzes/quiz-1.json"
      provides: "Lesson 1 quiz content (5 questions about Was ist KI)"
      min_lines: 50
  key_links:
    - from: "src/data/quiz-loader.js"
      to: "src/data/quizzes/quiz-*.json"
      via: "fetch with caching"
      pattern: "fetch.*quizzes/quiz-"
---

<objective>
Create quiz data structure and loader following the established lesson-loader.js pattern

Purpose: Provide the data foundation for the quiz system with properly structured German-language questions about "Was ist KI?" lesson content

Output: quiz-loader.js module and quiz-1.json data file
</objective>

<execution_context>
@C:\Users\Furby\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Furby\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/data/lesson-loader.js (pattern to follow)
@src/data/lessons/lesson-1.json (content reference for quiz questions)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create quiz-loader.js following lesson-loader pattern</name>
  <files>src/data/quiz-loader.js</files>
  <action>
Create quiz-loader.js following the exact pattern from lesson-loader.js:

1. Create quizCache Map for caching loaded quizzes
2. Create loadQuiz(lessonId) async function:
   - Check cache first, return if exists
   - Fetch from `./src/data/quizzes/quiz-${lessonId}.json`
   - On error, throw with German message "Quiz ${lessonId} nicht gefunden"
   - Call validateQuiz before caching
   - Cache and return quiz data
3. Create validateQuiz(quiz) function:
   - Check quiz.lessonId exists
   - Check quiz.title exists
   - Check quiz.questions is array
   - Check quiz.questions.length === 5 (requirement: exactly 5 questions)
   - For each question validate:
     - question.id exists
     - question.question (text) exists
     - question.answers is array of 4 options
     - Exactly one answer has correct: true
     - Each answer has id and text
   - Throw German error messages for validation failures
4. Export: loadQuiz, validateQuiz, clearQuizCache, isQuizCached

Use German error messages matching lesson-loader.js style.
  </action>
  <verify>File exists at src/data/quiz-loader.js with all exported functions</verify>
  <done>quiz-loader.js exports loadQuiz, validateQuiz and follows lesson-loader.js pattern</done>
</task>

<task type="auto">
  <name>Task 2: Create quiz-1.json with 5 questions about "Was ist KI?"</name>
  <files>src/data/quizzes/quiz-1.json</files>
  <action>
Create src/data/quizzes/ directory and quiz-1.json with:

Structure:
```json
{
  "lessonId": 1,
  "title": "Was ist KI? - Quiz",
  "questions": [/* 5 questions */]
}
```

Each question structure:
```json
{
  "id": 1,
  "question": "Question text in simple German",
  "answers": [
    { "id": "a", "text": "Answer A" },
    { "id": "b", "text": "Answer B", "correct": true },
    { "id": "c", "text": "Answer C" },
    { "id": "d", "text": "Answer D" }
  ],
  "feedback": {
    "correct": "Encouraging message for correct answer",
    "incorrect": "Gentle explanation of correct answer"
  }
}
```

5 Questions covering lesson-1.json content:
1. "Wofuer steht die Abkuerzung KI?" (Answer: Kuenstliche Intelligenz)
2. "Was koennen KI-Programme?" (Answer: Lernen)
3. "Was ist KEIN Beispiel fuer KI im Alltag?" (Pick the non-AI item)
4. "Wie lernt eine KI?" (Answer: Aus vielen Beispielen)
5. "Was braucht KI zum Lernen?" (Answer: Viele Beispiele)

Requirements:
- Short sentences (7-year-old reading level)
- Max 4-5 words per answer option
- German umlauts written as ae, oe, ue (JSON-safe)
- Encouraging feedback messages
- Incorrect feedback gently explains correct answer
  </action>
  <verify>cat src/data/quizzes/quiz-1.json | head -80 shows valid JSON with 5 questions</verify>
  <done>quiz-1.json contains 5 age-appropriate German questions about KI basics</done>
</task>

<task type="auto">
  <name>Task 3: Verify quiz loading works</name>
  <files>-</files>
  <action>
Create a simple test by:
1. Open browser dev tools console on the app
2. Import and call loadQuiz:
   ```javascript
   import('./src/data/quiz-loader.js').then(m => m.loadQuiz(1).then(console.log))
   ```
3. Verify quiz data loads correctly with all 5 questions
4. Test validation by checking error handling for missing quiz (e.g., quiz-99)

Alternative: Create a quick Node.js test script if browser testing is complex.
  </action>
  <verify>loadQuiz(1) returns quiz object with lessonId=1, title, and 5 questions array</verify>
  <done>Quiz loader successfully loads and validates quiz-1.json</done>
</task>

</tasks>

<verification>
- [ ] src/data/quiz-loader.js exists with loadQuiz, validateQuiz exports
- [ ] src/data/quizzes/quiz-1.json exists with valid structure
- [ ] Quiz has exactly 5 questions, each with 4 answers
- [ ] Each question has exactly one correct answer marked
- [ ] All text is age-appropriate German (7-year-old level)
- [ ] Loader validates structure and throws German errors
</verification>

<success_criteria>
1. loadQuiz(1) returns valid quiz data object
2. validateQuiz rejects invalid structures with clear German errors
3. Quiz content matches lesson-1.json topics
4. Pattern matches lesson-loader.js for consistency
</success_criteria>

<output>
After completion, create `.planning/phases/04-quiz-system/04-01-SUMMARY.md`
</output>
