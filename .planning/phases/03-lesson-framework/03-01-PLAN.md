---
phase: 03-lesson-framework
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/lesson-loader.js
  - src/data/lessons/lesson-1.json
autonomous: true

must_haves:
  truths:
    - "Lesson data can be loaded by ID"
    - "Lesson JSON contains 5-7 screens with child-friendly text"
    - "Each screen has Kiki emotion and optional message"
  artifacts:
    - path: "src/data/lesson-loader.js"
      provides: "Lesson data loading and caching"
      exports: ["loadLesson", "preloadAllLessons"]
    - path: "src/data/lessons/lesson-1.json"
      provides: "Complete Lesson 1 content"
      contains: "screens"
  key_links:
    - from: "lesson-loader.js"
      to: "JSON files"
      via: "fetch"
      pattern: "fetch.*lesson-.*\\.json"
---

<objective>
Create lesson data infrastructure: JSON loader with caching and complete Lesson 1 content.

Purpose: Establish the data layer for lessons before building the renderer.
Output: Working lesson loader and sample lesson JSON that serves as the template for all future lessons.
</objective>

<execution_context>
@C:\Users\Furby\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Furby\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-lesson-framework/03-RESEARCH.md

Key patterns from existing codebase:
- ES6 modules with named exports
- StateManager uses simple get/set pattern
- Views receive (container, state, params)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create lesson-loader.js</name>
  <files>src/data/lesson-loader.js</files>
  <action>
Create the lesson data loader module that fetches and caches lesson JSON files.

Implementation:
1. Create `src/data/` directory if it doesn't exist
2. Create `lesson-loader.js` with:
   - `lessonCache` Map for caching loaded lessons
   - `loadLesson(lessonId)` async function that:
     - Checks cache first, returns cached if exists
     - Fetches from `./src/data/lessons/lesson-${lessonId}.json`
     - Validates that response has `screens` array
     - Caches result before returning
     - Throws descriptive error on failure
   - `preloadAllLessons()` async function that loads all 7 lessons in parallel
   - Named exports for both functions

Pattern to follow:
```javascript
export async function loadLesson(lessonId) {
  if (lessonCache.has(lessonId)) {
    return lessonCache.get(lessonId);
  }
  // fetch, validate, cache, return
}
```

Error handling: Log to console.error, throw Error with descriptive message.
  </action>
  <verify>
File exists at src/data/lesson-loader.js with:
- `loadLesson` function exported
- `preloadAllLessons` function exported
- Cache implementation using Map
  </verify>
  <done>Lesson loader module created with caching and validation</done>
</task>

<task type="auto">
  <name>Task 2: Create Lesson 1 JSON content</name>
  <files>src/data/lessons/lesson-1.json</files>
  <action>
Create complete Lesson 1 "Was ist KI?" with 5 screens following the JSON schema from research.

Create `src/data/lessons/` directory and `lesson-1.json`:

```json
{
  "id": 1,
  "title": "Was ist KI?",
  "totalScreens": 5,
  "estimatedMinutes": 12,
  "screens": [...]
}
```

Screen structure for each of 5 screens:
1. **Intro screen (type: intro)**
   - kikiEmotion: "curious"
   - kikiMessage: "Hallo! Heute lernen wir, was KI ist!"
   - heading: "Was ist KI?"
   - text: "KI ist kurz fuer Kuenstliche Intelligenz."
   - subtext: "Das klingt schwer. Aber es ist ganz einfach!"
   - illustration: null (placeholder)

2. **Explanation screen (type: explanation)**
   - kikiEmotion: "happy"
   - kikiMessage: null
   - heading: "Computer, die lernen koennen"
   - text: "Normale Computer sind nicht schlau."
   - bullets: 3 items about how normal computers vs KI work
   - illustration: null

3. **Example screen (type: example)**
   - kikiEmotion: "thoughtful"
   - kikiMessage: "Schau mal, so lernt eine KI!"
   - heading: "So lernt KI"
   - text: "Zeig einer KI ganz viele Fotos von Hunden."
   - subtext: "Dann kann sie Hunde von alleine erkennen!"
   - illustration: null

4. **Interactive screen (type: interactive)**
   - kikiEmotion: "curious"
   - kikiMessage: "Was denkst du?"
   - heading: "Wo gibt es KI?"
   - text: "Rate mal: Wo ist KI drin?"
   - choices: 3 options with correct/feedback fields

5. **Summary screen (type: summary)**
   - kikiEmotion: "proud"
   - kikiMessage: "Super! Du hast Lektion 1 geschafft!"
   - heading: "Das hast du gelernt"
   - bullets: 3 key takeaways
   - nextAction: "Jetzt gibt es ein kleines Quiz!"

CRITICAL for child-friendly text:
- Maximum 10-12 words per sentence
- Use words a 7-year-old knows
- Active voice ("KI lernt" not "KI wird gelernt")
- No technical jargon without immediate explanation
- German umlauts as "ae", "oe", "ue" (no special chars in JSON)
  </action>
  <verify>
File exists at src/data/lessons/lesson-1.json that:
- Is valid JSON (no syntax errors)
- Has exactly 5 screens
- Each screen has type, kikiEmotion, content fields
- Text uses simple German for 7-year-olds
  </verify>
  <done>Lesson 1 JSON with 5 screens of child-friendly KI introduction content</done>
</task>

</tasks>

<verification>
1. JSON syntax valid: `cat src/data/lessons/lesson-1.json | python -m json.tool`
2. Module syntax valid: No import errors when loading lesson-loader.js
3. Text review: Each sentence is under 12 words, uses simple vocabulary
</verification>

<success_criteria>
- lesson-loader.js exports loadLesson and preloadAllLessons
- lesson-1.json is valid JSON with 5 screens
- All text appropriate for 7-year-old readers
- Lesson data structure matches schema from research
</success_criteria>

<output>
After completion, create `.planning/phases/03-lesson-framework/03-01-SUMMARY.md`
</output>
